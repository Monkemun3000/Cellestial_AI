{
  "title": "Analyzing the relationship between gene expression and phenotype in space-flown mice using a causal inference machine learning ensemble.",
  "url": "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC11748630/",
  "pmc_id": "11748630",
  "content": "Analyzing the relationship between gene expression and phenotype in space-flown mice using a causal inference machine learning ensemble Received 2024 Apr 12; Accepted 2024 Nov 26; Collection date 2025. Subject terms:Biotechnology, Computational biology and bioinformatics, Biomarkers, Risk factors Tools which are commonly used to analyze high-dimensional data, and ML algorithms in general, share an intrinsic flaw. They discover those patterns in data which minimize training error, but training data are often flawed by selection bias, label bias, capture bias, and negative set bias8. Algorithms which train on biased datasets inherit these data biases. Minimizing training error encourages algorithms to indiscriminately absorb all the correlations found in training data, real or spurious. Spurious correlations resulting from data biases are unrelated to the true underlying signal9. Recently, disambiguating true correlations from spurious ones has been studied in the context of causal inference. For this reason, we leverage tools from the causal inference domain to identify genes which are robustly correlated with a phenotype. While such genes are putatively causal, validating true causality is beyond the scope of this research. In this research, we use CRISP—an ensemble machine learning platform developed by the Frontier Development Laboratory (FDL) 2020 Astronaut Health team10to enhance biological and medical research with heterogeneous and high-dimensional observational data11. The FDL team used CRISP to identify genetic drivers that differentiate two subtypes of colorectal cancer and to implicate operational taxonomic units of the associated microbiome. NASA open science data repository This study uses transcriptomic data from four OSDR datasets: OSD-4717(version 11), OSD-4817(version 10), OSD-13718(version 6), and OSD-16817(version 10). These datasets were generated from three rodent research (RR) missions: RR-1 CASIS, RR-1 NASA, and RR-3. Two different strains of mice were used: C57 and Balb/C. The RR-1 CASIS experiment was designed to study the effects of microgravity of C57 mice on muscle degeneration due to spaceflight (OSD-47). The RR-1 NASA mission was designed to validate the experimental hardware and scientific capabilities on the International Space Station (OSD-48). The RR-3 mission was designed to study countermeasures in Balb/C mice for loss of mass in muscle and bone that have been observed in spaceflight (OSD-137 and OSD-168). The OSD-168 dataset was not based on a separate mission but rather to test the utility of External RNA Control Consortium (ERCC) RNA sequencing controls and therefore constitute technical replicates in our experiments. These rodent research missions were originally designed as randomized controlled experiments, with mice randomly assigned to the groups described in Table1. The four experimental groups of mice from the OSDR datasets. The basal, vivarium, and ground groups were combined as “non-flight” samples. In our analyses, we consider the mice in the basal, vivarium, and ground experimental groups as “non-flight” and compare them with the flight group. We are re-using these data to explore the relationship between the transcriptomes and a phenotype, constituting the data as observational in our research. Indeed, the causal inference algorithms in the CRISP platform ensemble were designed to run on observational data. Liver histology phenotype data Liver tissues used for gene expression were quantified for lipid density using the oil red O (ORO) staining protocol. ORO is a fat soluble, hydrophobic dye that stains lipid molecules red19. ORO percent positivity was calculated for each sample from the stained images, providing a scalar value that measures the lipid density—higher ORO positivity values directly correspond to higher lipid densities. ORO positivity is the de facto histological biomarker for diagnosing the spectrum of disorders in non-alcoholic fatty liver disease (NAFLD)post mortem. Because OSD-168 is comprised of technical replicates, the ORO positivity data are associated with the biological replicates in OSD-47, OSD-48, and OSD-137 and not in OSD-168 itself. A typical machine learning pipeline includes a data preprocessing step. At the very least, the data must be prepared to satisfy the assumptions and requirements of the algorithms which use the data. CRISP requires that the features be real-valued, that the target be binary, and that the environment string be ASCII text, as described in the following sections. The ORO positivity scalar values in our dataset range from 0.91 to 26.94, but the CRISP platform only permits binary targets (low and high) for classification. We converted the scalar value to a per-mission binary value using the mean value between flight and non-flight medians. The thresholds are depicted in the box-and-whisker plot of Fig.2as a horizontal dashed blue line. Box-and-whisker plots for ORO values (y-axis) based on mission (x-axis). The dashed blue line is the rodent research mission threshold that was calculated as the mean of the two group medians (yellow lines). The 2-sided student t-testp-values show that the differences between the medians of flight and non-flight samples are all significant. The top of each box represents the 75th percentile, the bottom of each box represents the 25th percentile, and the solid black lines on the very top and bottom represent the maxima and minima, respectively. Using the thresholds per mission indicated in Fig.2, a sample was assigned a binary target of 0 if its ORO positivity is less than the threshold value and 1 if its ORO positivity is greater than or equal to the threshold value. Feature transformations and data augmentation Description of and reference for each gene expression data transformation used in pre-processing of data. These 5 transformations (log, square root, median of ratios, centered log ratio, and Box-Cox) provide 6 times more data for building the models and create environments in which to leverage invariance for CRISP. The z-scores of each transformation were individually calculated prior to merging the datasets. Figure3shows the original data distribution (named “identity”) and the data after having been transformed and plotted as (variance vs mean) coordinates in log scale. Scatter plots of variance versus mean for different transformations used in preprocessing. The vertical and horizontal axes are shown in log2 scale after having standardized the data. The identity transformation represents the original, untransformed data. The square root (sqrt) transformation computes the square root of each expression value. The normalization (norm) transformation uses the median of ratios method from the R DESeq2 package. The centered log ratio (clr) method divides each row of gene expression data by the mean of that row and returns the logarithms of those ratios. The log transformation computes the logarithm (base 2) of each expression value. The boxcox transformation is a type of power transformation that makes the gene expression data more normally distributed. To prevent data leakage, we first separated the data into training, validation, and test datasets and standardized the training and validation sets separately31. We held out 90% of the raw data for testing and did not perform any transformations on it32. We held out 10% of the raw data for validation, and we used all the augmented data during the training phase. We examined the dataset for batch effects and found that only the type of library preparation of the RNA-seq experiments generating the transcriptomic data clearly separate the samples, as shown in Fig.4a. PCA plots of OSD datasets colorized by the different covariates, including (a) library preparation, (b) dataset, (c) experimental group, (d) mouse strain, and (e) Rodent Research study. The first two principal components capture 92% of the total variance of the gene expression. Colorizing by library preparation in Fig. 4a shows a distinct separation of all samples. Unlike Fig.4a (library preparation), Fig.4b–e do not show a clean separation of samples colored by covariate. To account for this library preparation batch effect, we include the library preparation in the environment string, as discussed in the following section. Constructing the environment string Table3shows a snippet of one fictitious sample’s input data after having performed the 5 data transformations and the standardization. The identity transformation is the original data, standardized. The environment string (here, called “env”) is a concatenation of the sample library preparation (here, “polyA”) and the transformation name (e.g. “boxcox”). Only the binary ORO threshold (called “oro_thresh”) for the sample remains unchanged across the same sample as well as for its respective technical replicates of OSD-168, if they exist. As a result of performing these 5 data transformations, our combined dataset size of 51 samples was increased six-fold to 306 samples. One fictitious mouse sample’s gene expression data (columns truncated to 2 genes) after 5 data transformations and standardization. The environment string (“env”) includes the name of the library preparation (“polyA” or “ribo-depleted”) and the name of the transformation. The binary ORO threshold (“oro_thresh”) is set to either 0 (low ORO positivity) or 1 (high ORO positivity). With the data in place, we turn now to how we run the CRISP in silico experiments. CRISP is an ensemble of machine learning algorithms. Ensembles are used to combine a set of multiple “weak” learners into a single “strong” learner to minimize training errors33. Each model in the ensemble is trained on the dataset to identify the features most predictive of the target. After training, each model selects the features (20 by default) which it found as most predictive of the target. For the linear models—linear invariant risk minimization (linear IRM) and linear invariant causal prediction (linear ICP)—the features which are most predictive are those whose coefficients of the linear model have the highest absolute values. For non-linear models—non-linear invariant risk minimization (non-linear IRM) and non-linear invariant causal prediction (non-linear ICP)—the most predictive features are selected through sensitivity analysis (the features which have the highest impact on the response variable). After each model has selected its top-most predictive features, the ensemble votes to elect a single set of (by default, 20) features to present as the final result of the experiment. Non-Causal Empirical risk minimization (ERM) and random forest (RF) are not causal predictors and do not participate in CRISP’s selection of the features. Non-causal ERM relies on statistical minimization of risk or error, while RF is another non-causal method which combines decision trees for a classification result. They are included in the experiment only as a basis of comparison to the causal predictors (non-linear IRM, linear ICP, non-linear ICP, and linear IRM). CRISP attributes the highest weight to the feature that the highest accuracy model gives the largest coefficient (or highest sensitivity). Conversely, the lowest ranking feature from the worst performing model will be attributed the lowest weight. Furthermore, the higher degree of concordance across the ensemble (i.e. how many models found the feature in their top 20 list), the higher the weighted coefficient of that feature. This attribution weightw(k)of featurekis calculated as shown in the following equation. The valuespkrepresent the fraction of models which found this featurekin its list of top (by default, 20) features. The numberMis the number of models CRISP is configured to use. The valuessm(k)are the absolute values of the linear coefficients (for linear models) or sensitivity factors (for non-linear models) scaled to the unit interval. The valuesamare the predictive accuracies of the models. In this way, CRISP identifies those features that are most predictive of the target from the highest number of best performing models. Each of the models in the ensemble trains on the same data set to identify the features which best predict the target across all environments. Figure5depicts the confusion matrices and performance metrics for each model in the ensemble. The bar chart in Fig.6shows the degree to which each gene across the ensemble is predictive of the lipid density response variable. Based on Fig.6, we see that theMup11gene was found in the top 20 genes most predictive of lipid density in all 5 models. By contrast, theFasngene was found in the top 20 genes most predictive of lipid density in only 3 of the models. The weight of the top 20 genes and their degree of concordance across the ensemble. The direction of the bar indicates whether the gene expression is predictive of high or low lipid density. Each bar is colored by the number of models which found that gene in their list of the top 20 most predictive genes. The biological functions of the 20 CRISP genes are shown in Table4. The functions were derived from the information provided in the NCBI Gene tool athttps://www.ncbi.nlm.nih.gov/gene/. The top 20 mouse genes identified in the CRISP experiment as robustly predictive of the threshold lipid density phenotype (listed alphabetically) and a short description of the protein they encode. We will discuss later in this section that the genes CRISP found are not only involved in lipid metabolism but many have also been implicated in NAFLD. Validation using gene set enrichment analysis We used the 20 genes from the CRISP experiment to perform Gene Set Enrichment Analysis (GSEA,https://www.gsea-msigdb.org/gsea/msigdb/annotate.jsp) using the Human Molecular Signatures Database (MSigDB) ontology gene sets (C5) collection version v2023.2.Mm. This tool finds those gene ontologies from all ontology gene sets (GO: Gene Ontology and HPO: Human Phenotype Ontology) that have a significant overlap with the query gene set in the mouse genome. Table5shows the top gene sets in the C5 collection that significantly overlap with these 20 mouse genes. Gene set enrichment analysis using gene ontology gene sets, showing the false discovery rate (FDR) adjusted significance q-value. All of these gene sets statistically significantly overlap the CRISP gene result set and their associated biological processes are directly involved in the metabolism of lipid proteins. The genes which enrich these gene sets includeApoc3,Apoc1,Cyp2e1,Scd1,Fasn,Star,Gamt,Apoe,Cyp3a41b, andAlg5. These gene sets are consistent with our lipid density phenotype as they are involved in the metabolism of fats, and we will explore the scientific literature to determine how these genes are implicated in NAFLD in the “Validation from scientific literature” section. Validation using pathway analysis Enriched gene ontology pathways involving the genes from the CRISP experiment. Using the enrichment false discovery rate metric of significance, the significant pathways relating to our gene set include cholesterol metabolism, fatty acid metabolism, and alcoholic liver disease. Cholesterol and fatty acid metabolism are consistent with both our gene set enrichment analysis as well as our lipid density phenotype. Lipid dysregulation is a key factor of fatty liver disease: the accumulation of lipids creates a lipotoxic environment that can lead to inflammation, oxidative stress, fibrosis, and liver damage. The genes enriching these 3 pathways includeApoe,Star,Apoc3,Apoc1,Fasn,Scd1, andCyp2e1. We will explore the scientific literature to determine how these genes are implicated in NAFLD in the “Validation from scientific literature” section. The Scalable Precision Medicine Open Knowledge Engine (SPOKE) is a massive knowledge graph of biomedical information which may be leveraged for a variety of purposes from drug discovery to disease diagnosis35. We used SPOKEv5 to identify disease conditions (derived from the Disease Ontology Knowledgebase36) from the list of 20 genes that CRISP found. Table7identifies those disease conditions and their associated adjustedp-value. Disease ontologies and associated Bonferroni-corrected p-values. All the disease ontology identifiers (DOID) that SPOKE found as statistically significantly associated with the CRISP result gene set are related to dysfunctional lipid metabolism. All these statistically significant disease ontologies are consistent with a high lipid density phenotype and NAFLD. Metabolic dysfunction-associated steatotic liver disease (MASLD) is the more recent term used for NAFLD. Validation from scientific literature Table8shows one relatively recent and relevant research article that discusses the relationship of NAFLD to each of the CRISP genes which enrich the pathways and gene sets previously discussed. Research articles implicating the changes in expression of the CRISP-identified genes in the spectrum of lipid dysregulation and NAFLD. Selection criteria for these articles include journal impact factor (greater than 3), date of publication (within the last 10 years), and relevance to a causal relationship between expression of the gene and the progression of NAFLD. Except forAlg5, all the genes from the gene set and pathway enrichment analyses have previously been shown to be dysregulated in liver inflammation, liver disease, non-alcoholic steatohepatitis (NASH), and NAFLD. Fuior et al. discuss how the overexpression ofApoc1in mice may lead to hyperlipidemia. Lu et al. demonstrated that overexpression ofApoc3manifests in features similar to NAFLD, including increased hepatic lipid content. Harjumaki et al. discuss the role ofCyp2e1in the development of NASH which is a precursor condition to NAFLD, suggesting that the over-expression of theCyp2e1enzyme and subsequent oxidative stress is sufficient to induce hepatic lipid accumulation. Woolsey et al. found that hepatic mRNA expression ofCyp3a41bin NASH was 69% lower than control livers. Testing its pharmacological inhibition in human cell culture, O’Farrell et al. considerFasnto be a promising therapeutic target for NASH as they observed that its reduced expression reduced overall triglyceride content, markers of fibrosis and inflammation, and development of hepatocellular carcinoma. TheGamtgene encodes an enzyme which helps synthesize creatine, and Marinello et al. found that its supplementation has been demonstrated to prevent NAFLD progression. Qin et al. describe how aberrant transcriptional activation ofScd1causes excessive lipid accumulation and promotes progression of NAFLD (among other metabolic complications), making it a promising therapeutic target. Finally, Qiu et al. found thatStaroverexpression, among other protective roles, can reduce hepatic lipid accumulation—suggesting it may be a potential therapeutic target for NAFLD. We used DESeq2 version 1.34.0 to perform differential gene expression analysis (DGEA) on the data on the same set of genes as we used in CRISP to identify which genes are significantly differentially expressed between the high and low ORO groups. DESeq2 performs its own filtering and normalization steps, so we did not transform the data. Because of the distinct batch effect due to library preparation, we added the library preparation covariate to the column data and included it in the DESeq2 design formula along with the ORO threshold value. DESeq2 did not find any genes that were significantly differentially expressed when setting the Benjamini–Hochberg adjustedp-value cutoff to 0.05. We used EdgeR version 3.36.0 to perform DGEA on the data on the same set of genes as we used in CRISP to identify which genes are significantly differentially expressed between the high and low ORO groups. EdgeR performs its own filtering and normalization steps, so we did not transform the data. Because of the distinct batch effect due to library preparation, we added the library preparation covariate to the column data and included it in the EdgeR design formula along with the ORO threshold value. Table9shows the 6 differentially expressed genes from the EdgeR experiment using 0.05 as the Bonferroni adjusted p-value threshold and not using a log2 fold change threshold. Gene result set using EdgeR to find differentially expressed genes between low and high ORO groups. Half of these genes are involved in lipid metabolism (Akr1b7,Tpm2, andStar). Taken together, the genes enriched in the pathways and gene sets shown in Tables5and6includeAlg5,Apoc1,Apoc3,Apoe,Cyp2e1,Cyp3a41b, Fasn,Gamt, Scd1, andStar.Figure7shows the box-and-whisker plots of the distributions of the raw counts of gene expression for each of these 10 genes between the flight samples and non-flight samples. Box-and-whisker plots of the distributions of gene expression for each of the genes with associated Wilcoxonp-values comparing flight and non-flight groups. Severalp-values are not statistically significant, suggesting that only using statistics to analyze differences in gene expression between groups may not be sufficient. As opposed to the non-specific pathways enriched by the EdgeR genes, the CRISP genes enrich lipid metabolism pathways including cholesterol, fatty acid, and NAFLD pathways—all of which are consistent with using lipid density as a response in our machine learning models. The NAFLD pathway is significantly enriched by the CRISP gene result set and includesCyp2e1,Fasn, andScd1genes with a 0.014 strength of association, as shown in Table6. As noted in Table8, the literature is consistent in finding these genes implicated in experiments on NAFLD. Moreover, the SPOKE knowledge graph found MASLD (the new name for NAFLD) to be the most significantly associated disease ontology with the CRISP gene result set. The use of data augmentation in this CRISP experiment is crucial. Not only does augmentation provide known perturbations of the data as required by CRISP, data augmentation also provides more samples to train, test, and validate the ensemble of machine learning classifiers. Even so, having more samples than 51 would enrich the underlying gene expression signals which would lead to even more robust correlations. We therefore recommend future spaceflight experiments to increase the cohort size and make the liver a standard tissue to collect, process, and analyze. We acknowledge a caveat that the OSD-137 study used the Balb/c mouse strain, while the other three studies used the C57BL6 strain. These two mouse strains are known to have differing responses to spaceflight5. Thus, a future study would benefit from further investigating the responses of the different mouse strains in larger cohorts. JC designed and executed the CRISP experiments, made the updates to the CRISP software, and wrote most of the manuscript. RS and JG identified the mouse liver transcriptomic and histological lipid data. MM interpreted the pathway analyses. HC analyzed some of the underlying algorithms of the CRISP platform. ASB, AH, LS, GM, and SC reviewed the manuscript and provided integral feedback. All the mouse liver transcriptomic data and histological lipid data are available athttps://osdr.nasa.gov. Direct links to the individual datasets are as follows:https://osdr.nasa.gov/bio/repo/data/studies/OSD-47,https://osdr.nasa.gov/bio/repo/data/studies/OSD-48,https://osdr.nasa.gov/bio/repo/data/studies/OSD-137,https://osdr.nasa.gov/bio/repo/data/studies/OSD-168. All software for this experiment is athttps://github.com/nasa/AI4LS/tree/main/crispv1.1. The authors declare no competing financial or non-financial interests with respect to this research. Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations. All the mouse liver transcriptomic data and histological lipid data are available athttps://osdr.nasa.gov. Direct links to the individual datasets are as follows:https://osdr.nasa.gov/bio/repo/data/studies/OSD-47,https://osdr.nasa.gov/bio/repo/data/studies/OSD-48,https://osdr.nasa.gov/bio/repo/data/studies/OSD-137,https://osdr.nasa.gov/bio/repo/data/studies/OSD-168. All software for this experiment is athttps://github.com/nasa/AI4LS/tree/main/crispv1.1.",
  "content_length": 24270,
  "scraped_date": "2025-10-04 11:55:21"
}